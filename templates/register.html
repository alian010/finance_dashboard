<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<script src="https://cdn.tailwindcss.com"></script>
	<title>Register | Finance Dashboard</title>
</head>

<body class="min-h-screen bg-slate-950 text-slate-100 flex items-center justify-center p-6">
	<div class="w-full max-w-md bg-slate-900/60 border border-slate-800 rounded-2xl p-6 shadow">
		<h1 class="text-2xl font-semibold">Create account</h1>

		<form id="registerForm" class="mt-6 space-y-4">
			<div>
				<label class="block text-sm text-slate-300 mb-1">Username</label>
				<input id="username"
					class="w-full rounded-xl bg-slate-950 border border-slate-800 px-4 py-3 outline-none focus:border-slate-600"
					placeholder="your username" autocomplete="username" />
			</div>

			<div>
				<label class="block text-sm text-slate-300 mb-1">Email</label>
				<input id="email" type="email"
					class="w-full rounded-xl bg-slate-950 border border-slate-800 px-4 py-3 outline-none focus:border-slate-600"
					placeholder="you@example.com" autocomplete="email" />
			</div>

			<div>
				<label class="block text-sm text-slate-300 mb-1">Password</label>
				<input id="password" type="password"
					class="w-full rounded-xl bg-slate-950 border border-slate-800 px-4 py-3 outline-none focus:border-slate-600"
					placeholder="min 8 chars" autocomplete="new-password" />
			</div>

			<button type="submit"
				class="w-full rounded-xl bg-white text-slate-950 font-medium py-3 hover:opacity-90 transition">
				Register
			</button>
		</form>

		<div class="mt-3 text-sm">
			<a class="text-slate-300 underline" href="/api/auth/login/">Already have an account? Login</a>
		</div>

		<pre id="output" class="mt-4 bg-slate-950 border border-slate-800 rounded-xl p-3 text-xs overflow-auto"></pre>
	</div>

	<script>
		const outputEl = document.getElementById("output");
		function setOutput(obj) {
			outputEl.textContent = typeof obj === "string" ? obj : JSON.stringify(obj, null, 2);
		}

		document.getElementById("registerForm").addEventListener("submit", async (e) => {
			e.preventDefault();
			const username = document.getElementById("username").value.trim();
			const email = document.getElementById("email").value.trim();
			const password = document.getElementById("password").value;

			try {
				const res = await fetch("/api/auth/register/", {
					method: "POST",
					headers: { "Content-Type": "application/json" },
					body: JSON.stringify({ username, email, password }),
				});

				const data = await res.json();
				if (!res.ok) {
					setOutput(data);
					return;
				}

				setOutput({ message: "Registration success âœ…", data });

				// Optional: auto-redirect to login page
				setTimeout(() => window.location.href = "/api/auth/login/", 900);

			} catch (err) {
				setOutput(String(err));
			}
		});
	</script>
</body>

</html>